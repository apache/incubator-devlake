# Data Model â€” GitHub Copilot Adoption Plugin

Date: December 11, 2025  
Branch: `001-copilot-metrics-plugin`

## Raw Layer

### `_raw_copilot_metrics`
| Field | Type | Description |
|-------|------|-------------|
| `id` | bigint (auto) | Primary key generated by DevLake raw table helper |
| `params` | json | Request metadata (org, start_date, end_date, endpoint) |
| `data` | json | Raw response payload from GitHub Copilot metrics API |
| `created_at` | timestamp | Ingestion timestamp |

### `_raw_copilot_seats`
| Field | Type | Description |
|-------|------|-------------|
| `id` | bigint (auto) | Primary key |
| `params` | json | Request metadata for seat fetch |
| `data` | json | Raw seat assignment response |
| `created_at` | timestamp | Ingestion timestamp |

## Tool Layer

### `CopilotConnection` (`_tool_copilot_connections`)
| Field | Type | Notes |
|-------|------|-------|
| `id` | uint64 (PK) | Auto-increment connection id |
| `name` | varchar(255) | Human-readable label |
| `endpoint` | varchar(255) | GitHub REST endpoint (default `https://api.github.com`) |
| `token` | text | Encrypted GitHub PAT |
| `organization` | varchar(255) | GitHub organization login |
| `rate_limit_per_hour` | int | Optional override, default 5000 |
| `created_at` | timestamp | Audit |
| `updated_at` | timestamp | Audit |

### `CopilotScope` (`_tool_copilot_scopes`)
| Field | Type | Notes |
|-------|------|-------|
| `connection_id` | uint64 (PK part) | FK to `CopilotConnection` |
| `scope_id` | varchar(255) (PK part) | Deterministic ID (org slug) |
| `organization` | varchar(255) | Redundant for quick filtering |
| `implementation_date` | date | Optional adoption go-live date (Phase 2 uses) |
| `baseline_period_days` | int | Default 90 (stored even if not used in Phase 1) |
| `seats_last_synced_at` | timestamp | Bookmark for seat fetch |
| `created_at` | timestamp | Audit |
| `updated_at` | timestamp | Audit |

### `CopilotOrgMetrics` (`_tool_copilot_org_metrics`)
| Field | Type | Notes |
|-------|------|-------|
| `connection_id` | uint64 (PK part) | |
| `scope_id` | varchar(255) (PK part) | |
| `date` | date (PK part) | Calendar day |
| `total_active_users` | int | Users with any activity |
| `total_engaged_users` | int | Users with completions/acceptances |
| `completion_suggestions` | int | Suggestions served |
| `completion_acceptances` | int | Suggestions accepted |
| `completion_lines_suggested` | int | Lines suggested |
| `completion_lines_accepted` | int | Lines accepted |
| `ide_chats` | int | Total IDE chat conversations |
| `ide_chat_copy_events` | int | Copy events |
| `ide_chat_insertion_events` | int | Insertion events |
| `ide_chat_engaged_users` | int | Users using IDE chat |
| `dotcom_chats` | int | GitHub.com chat conversations |
| `dotcom_chat_engaged_users` | int | GitHub.com chat engaged |
| `seat_active_count` | int | Optional caching from billing summary |
| `seat_total` | int | Total licensed seats at fetch time |
| `created_at` | timestamp | Audit |

### `CopilotLanguageMetrics` (`_tool_copilot_language_metrics`)
| Field | Type | Notes |
|-------|------|-------|
| `connection_id` | uint64 (PK part) | |
| `scope_id` | varchar(255) (PK part) | |
| `date` | date (PK part) | |
| `editor` | varchar(50) (PK part) | IDE identifier |
| `language` | varchar(50) (PK part) | Programming language |
| `engaged_users` | int | Unique engaged users |
| `code_suggestions` | int | Suggestions served |
| `code_acceptances` | int | Suggestions accepted |
| `lines_suggested` | int | Lines suggested |
| `lines_accepted` | int | Lines accepted |
| `created_at` | timestamp | Audit |

### `CopilotSeat` (`_tool_copilot_seats`)
| Field | Type | Notes |
|-------|------|-------|
| `connection_id` | uint64 (PK part) | |
| `organization` | varchar(255) (PK part) | |
| `user_login` | varchar(255) (PK part) | Raw GitHub login |
| `user_id` | bigint | GitHub user ID |
| `plan_type` | varchar(32) | Typically `business` or `enterprise` |
| `created_at` | timestamp | Seat assignment time |
| `last_activity_at` | timestamp nullable | Last recorded Copilot activity |
| `last_activity_editor` | varchar(128) | Editor or feature name |
| `last_authenticated_at` | timestamp nullable | Last authentication |
| `pending_cancellation_date` | timestamp nullable | Future cancellation date |
| `updated_at` | timestamp | Sync timestamp |

## Derived Views (Grafana SQL)

- **Adoption Trend View**: Aggregates `total_active_users` and `total_engaged_users` per day, supports 7/30/90 day averages.
- **Language Usage View**: Sums `code_suggestions` and `code_acceptances` per language/editor, default top 10 languages.
- **Seat Activity View**: Computes seat adoption timeline using `created_at` counts and `last_activity_at` recency buckets.
