id,pull_request_id,body,user_id,created_date,commit_sha,position
github:GithubPullRequest:1:407675431,github:GithubPullRequest:1:203756736,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=h1) Report\n> Merging [#4](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/f5b37d0798a8e4c6780a1e08270fa50e979aa1d7?src=pr&el=desc) will **not change** coverage.\n> The diff coverage is `100%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/4/graphs/tree.svg?token=JFa3laaGKq&width=650&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=tree)\n\n```diff\n@@          Coverage Diff          @@\n##           master     #4   +/-   ##\n=====================================\n  Coverage     100%   100%           \n=====================================\n  Files           5      5           \n  Lines         237    241    +4     \n=====================================\n+ Hits          237    241    +4\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [worker.go](https://codecov.io/gh/panjf2000/ants/pull/4/diff?src=pr&el=tree#diff-d29ya2VyLmdv) | `100% <100%> (ø)` | :arrow_up: |\n| [worker\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/4/diff?src=pr&el=tree#diff-d29ya2VyX2Z1bmMuZ28=) | `100% <100%> (ø)` | :arrow_up: |\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/4/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `100% <100%> (ø)` | :arrow_up: |\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/4/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `100% <100%> (ø)` | :arrow_up: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=footer). Last update [f5b37d0...83042d7](https://codecov.io/gh/panjf2000/ants/pull/4?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-07-25T08:25:22.000+00:00,,0
github:GithubPullRequest:1:407714136,github:GithubPullRequest:1:203756736,"""@barryz 改的不错，不过有一点需要商榷，那个预分配的大小，之前benchmark我记得1000w也只需要用到7w多，这样的话预分配5w对于大部分场景其实有点浪费，你有没有用修改后的代码benchmark一下，每次allocs/op应该是变大了吧""",github:GithubAccount:1:7496278,2018-07-25T10:49:44.000+00:00,,0
github:GithubPullRequest:1:407755528,github:GithubPullRequest:1:203756736,"""@panjf2000  因为从压测结果来看， 1000W的场景下goroutine池的作用很明显， 尤其是在节省内存开销方面，所以在选择默认worker数量时，取了一个相对较大的值。 下面是benchmark 对比\r\n\r\nmaster:\r\n\r\n```\r\ngoos: linux\r\ngoarch: amd64\r\nBenchmarkGoroutineWithFunc-4           1        15079030287 ns/op       723120296 B/op  10176159 allocs/op\r\nPASS\r\nok      command-line-arguments  15.106s\r\n```\r\n\r\nPR:\r\n```\r\ngoos: linux\r\ngoarch: amd64\r\nBenchmarkGoroutineWithFunc-4           1        15443376244 ns/op       720962888 B/op  10167850 allocs/op\r\nPASS\r\nok      command-line-arguments  15.479s\r\n```\r\n""",github:GithubAccount:1:16658738,2018-07-25T13:33:42.000+00:00,,0
github:GithubPullRequest:1:407764945,github:GithubPullRequest:1:203756736,"""@barryz 这样看起来预分配似乎没有太大的内存优势，相反在其他数量的任务量场景下可能还会有点浪费，这样吧，要不你先把预分配内存这一块的暂时移除，然后我合一下优化代码的部分，至于预分配内存这一块，后续再继续讨论下看看有没有能兼顾的办法""",github:GithubAccount:1:7496278,2018-07-25T14:02:41.000+00:00,,0
github:GithubPullRequest:1:416794440,github:GithubPullRequest:1:211603583,"""@hongli-my 不好意思，我没太懂你的意图？能麻烦说详细点吗？""",github:GithubAccount:1:7496278,2018-08-29T01:39:23.000+00:00,,0
github:GithubPullRequest:1:416794871,github:GithubPullRequest:1:211603583,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=h1) Report\n> Merging [#8](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/666635c65d8d3bb1223b819325e0bd23c81f2733?src=pr&el=desc) will **decrease** coverage by `1.24%`.\n> The diff coverage is `100%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/8/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master       #8      +/-   ##\n==========================================\n- Coverage     100%   98.75%   -1.25%     \n==========================================\n  Files           5        5              \n  Lines         241      241              \n==========================================\n- Hits          241      238       -3     \n- Misses          0        2       +2     \n- Partials        0        1       +1\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/8/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `100% <100%> (ø)` | :arrow_up: |\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/8/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `97.19% <0%> (-2.81%)` | :arrow_down: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=footer). Last update [666635c...afd6871](https://codecov.io/gh/panjf2000/ants/pull/8?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-08-29T01:42:05.000+00:00,,0
github:GithubPullRequest:1:416803651,github:GithubPullRequest:1:211603583,"""```n := 0\r\n\t\tfor i, w := range idleWorkers {\r\n\t\t\tif currentTime.Sub(w.recycleTime) <= p.expiryDuration {\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\tn = i\r\n\t\t\tw.args <- nil\r\n\t\t\tidleWorkers[i] = nil\r\n\t\t}\r\n\t\tn++\r\n\t\tif n >= len(idleWorkers) {\r\n\t\t\tp.workers = idleWorkers[:0]\r\n\t\t} else {\r\n\t\t\tp.workers = idleWorkers[n:]\r\n\t\t}```\r\nfor 循环中，如果for 循环没有满足条件，n 并没有复制，此时n ++,   n 变为1， p.workers = idleWorkers[1:],  idleWorkers[0] 丢弃了？ 但是并没有w.args <- nil 操作""",github:GithubAccount:1:8597823,2018-08-29T02:34:07.000+00:00,,0
github:GithubPullRequest:1:416818094,github:GithubPullRequest:1:211603583,"""@hongli-my 嗯，我知道了，但是你的修改似乎不完整，我已经在develop分支改了一版，要不你看下那个分支，然后按照那个再改一下，然后我再merge""",github:GithubAccount:1:7496278,2018-08-29T04:11:17.000+00:00,,0
github:GithubPullRequest:1:421884048,github:GithubPullRequest:1:211603583,"""对于worker中的chan应该也需要close吧，当协程数量增大时，这种也是一种消耗""",github:GithubAccount:1:29241786,2018-09-17T03:37:44.000+00:00,,0
github:GithubPullRequest:1:425423544,github:GithubPullRequest:1:218939809,"""@liyonglion 我看修改的代码应该是正确的，但是有两个问题：\r\n1. 要正确测试你pr，你要把ants_test.go里import ants的路径改成你自己的路径；\r\n2. 你现在只修改了pool.go的代码，麻烦把pool_func.go里相应的地方也优化一下。\r\n\r\n你重新修改一下pr，然后通过测试，我就merge了。""",github:GithubAccount:1:7496278,2018-09-28T12:43:30.000+00:00,,0
github:GithubPullRequest:1:425428914,github:GithubPullRequest:1:218939809,"""我又仔细地想了想，在putWorker方法中，调用p.cond.Signal()之前，p.lock已经解锁了，如果这时候被\r\n![image](https://user-images.githubusercontent.com/7496278/46209831-824b0a00-c361-11e8-9109-609d21bab572.png)\r\n这里获得锁，则空闲队列中的刚刚放入的worker会被取出，这时候p.cond.Wait()再获得锁去队列中取worker的时候就会取不到，len(p.workers) - 1就会是-1，会报错：index out of range，和https://github.com/panjf2000/ants/issues/6 相似的问题，所以p.cond.Signal()应该放在putWorker中的p.lock.Lock()和p.lock.Unlock()之间。\r\n""",github:GithubAccount:1:7496278,2018-09-28T13:03:48.000+00:00,,0
github:GithubPullRequest:1:425431081,github:GithubPullRequest:1:218939809,"""我明天仔细研究下。如果这个地方的死锁不好解决，其实可以使用另外一把锁，专门给条件变量使用。""",github:GithubAccount:1:12890888,2018-09-28T13:12:08.000+00:00,,0
github:GithubPullRequest:1:425432498,github:GithubPullRequest:1:218939809,"""单一操作变量最好不要有多个锁，这样引发死锁的概率会非常高。""",github:GithubAccount:1:7496278,2018-09-28T13:17:44.000+00:00,,0
github:GithubPullRequest:1:425438107,github:GithubPullRequest:1:218939809,"""新的锁只给条件变量使用，其他任何地方都不会使用。如果怕死锁，明天我封装一层，pool层只有一把锁。""",github:GithubAccount:1:12890888,2018-09-28T13:37:48.000+00:00,,0
github:GithubPullRequest:1:425439137,github:GithubPullRequest:1:218939809,"""封装一层后，按照你的思路修改应该就可以了。""",github:GithubAccount:1:12890888,2018-09-28T13:41:20.000+00:00,,0
github:GithubPullRequest:1:425608265,github:GithubPullRequest:1:218939809,"""看了下代码，你说的没错。我在测试下性能方面""",github:GithubAccount:1:12890888,2018-09-29T02:22:39.000+00:00,,0
github:GithubPullRequest:1:425609411,github:GithubPullRequest:1:218939809,"""![image](https://user-images.githubusercontent.com/7496278/46240052-34bbb500-c3d4-11e8-809b-46b429039aee.png)\r\n你这改的有问题，取出来后没有对workers队列缩容，现在Travis CI整个卡住了""",github:GithubAccount:1:7496278,2018-09-29T02:41:56.000+00:00,,0
github:GithubPullRequest:1:425609608,github:GithubPullRequest:1:218939809,"""嗯，到时候我会补上。容我再想想""",github:GithubAccount:1:12890888,2018-09-29T02:45:23.000+00:00,,0
github:GithubPullRequest:1:425622339,github:GithubPullRequest:1:218939809,"""性能测试如下：\r\n100w的并发，5w的goroutine\r\n![snip20180929_3](https://user-images.githubusercontent.com/12890888/46242225-93932580-c3f8-11e8-841c-fc7fc620313d.png)\r\n\r\n![snip20180929_5](https://user-images.githubusercontent.com/12890888/46242227-9beb6080-c3f8-11e8-80fa-5d01da9aba19.png)\r\n""",github:GithubAccount:1:12890888,2018-09-29T07:02:56.000+00:00,,0
github:GithubPullRequest:1:425622437,github:GithubPullRequest:1:218939809,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=h1) Report\n> Merging [#13](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/af376f1b7b59dc488458bcecd4273f0fcde33c55?src=pr&el=desc) will **decrease** coverage by `90.38%`.\n> The diff coverage is `5%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/13/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master     #13       +/-   ##\n==========================================\n- Coverage   98.75%   8.36%   -90.39%     \n==========================================\n  Files           5       5               \n  Lines         241     239        -2     \n==========================================\n- Hits          238      20      -218     \n- Misses          1     214      +213     \n- Partials        2       5        +3\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/13/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `0% <0%> (-97.23%)` | :arrow_down: |\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/13/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `18.86% <10%> (-81.14%)` | :arrow_down: |\n| [worker\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/13/diff?src=pr&el=tree#diff-d29ya2VyX2Z1bmMuZ28=) | `0% <0%> (-100%)` | :arrow_down: |\n| [worker.go](https://codecov.io/gh/panjf2000/ants/pull/13/diff?src=pr&el=tree#diff-d29ya2VyLmdv) | `0% <0%> (-100%)` | :arrow_down: |\n| [ants.go](https://codecov.io/gh/panjf2000/ants/pull/13/diff?src=pr&el=tree#diff-YW50cy5nbw==) | `0% <0%> (-100%)` | :arrow_down: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=footer). Last update [af376f1...1846b43](https://codecov.io/gh/panjf2000/ants/pull/13?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-09-29T07:05:01.000+00:00,,0
github:GithubPullRequest:1:425623081,github:GithubPullRequest:1:218939809,"""@panjf2000  这个覆盖率怎么看？""",github:GithubAccount:1:12890888,2018-09-29T07:16:02.000+00:00,,0
github:GithubPullRequest:1:425632550,github:GithubPullRequest:1:218939809,"""怎么会有负数。。。""",github:GithubAccount:1:7496278,2018-09-29T09:53:47.000+00:00,,0
github:GithubPullRequest:1:425632613,github:GithubPullRequest:1:218939809,"""而且你那个取出worker之后还是没有对队列进行缩容吧""",github:GithubAccount:1:7496278,2018-09-29T09:54:48.000+00:00,,0
github:GithubPullRequest:1:425632632,github:GithubPullRequest:1:218939809,"""这个我没玩过。。。。""",github:GithubAccount:1:12890888,2018-09-29T09:55:07.000+00:00,,0
github:GithubPullRequest:1:425632777,github:GithubPullRequest:1:218939809,"""@panjf2000  我缩容了，具体哪个地方？""",github:GithubAccount:1:12890888,2018-09-29T09:57:34.000+00:00,,0
github:GithubPullRequest:1:425637776,github:GithubPullRequest:1:218939809,"""@liyonglion 我看错了，缩容的补上了，这块没什么问题了，关于覆盖率这块我明天再查查。。。""",github:GithubAccount:1:7496278,2018-09-29T11:25:56.000+00:00,,0
github:GithubPullRequest:1:425637938,github:GithubPullRequest:1:218939809,"""哦，我知道了，应该是那个import路径的问题导致的，那我先merge一下代码""",github:GithubAccount:1:7496278,2018-09-29T11:29:28.000+00:00,,0
github:GithubPullRequest:1:425896318,github:GithubPullRequest:1:219363161,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=h1) Report\n> Merging [#14](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/1b62696050b7030106291980d5220f886b017eff?src=pr&el=desc) will **decrease** coverage by `2.12%`.\n> The diff coverage is `100%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/14/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff            @@\n##           master     #14      +/-   ##\n=========================================\n- Coverage   98.32%   96.2%   -2.13%     \n=========================================\n  Files           5       5              \n  Lines         239     237       -2     \n=========================================\n- Hits          235     228       -7     \n- Misses          2       4       +2     \n- Partials        2       5       +3\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/14/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `96.19% <100%> (-1.93%)` | :arrow_down: |\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/14/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `95.28% <100%> (-2.85%)` | :arrow_down: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=footer). Last update [1b62696...5ed1687](https://codecov.io/gh/panjf2000/ants/pull/14?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-10-01T12:53:39.000+00:00,,0
github:GithubPullRequest:1:425906970,github:GithubPullRequest:1:219363161,"""thanks for your correction and could you also modify the pool_func.go cuz there is also the same useless statement in that file. i will accept this pr after your modification is done, thanks.""",github:GithubAccount:1:7496278,2018-10-01T13:27:04.000+00:00,,0
github:GithubPullRequest:1:426537013,github:GithubPullRequest:1:219936521,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=h1) Report\n> Merging [#15](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/29730bb70343924a2f56a13a9799611dd1cd27fd?src=pr&el=desc) will **decrease** coverage by `0.84%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/15/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff            @@\n##           master     #15      +/-   ##\n=========================================\n- Coverage   97.04%   96.2%   -0.85%     \n=========================================\n  Files           5       5              \n  Lines         237     237              \n=========================================\n- Hits          230     228       -2     \n- Misses          3       4       +1     \n- Partials        4       5       +1\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/15/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `96.19% <0%> (-1.91%)` | :arrow_down: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=footer). Last update [29730bb...3070771](https://codecov.io/gh/panjf2000/ants/pull/15?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-10-03T07:23:08.000+00:00,,0
github:GithubPullRequest:1:426596957,github:GithubPullRequest:1:219936521,"""@egonelbre thanks for your interest in this repository and i got some puzzles.\r\nfirstly, i don't understand why you use both the chan struct{} and sync.WaitGroup at once, that seems a bit excessive cuz waitgroup and chan did the same thing.\r\nsecondly, method BenchmarkGoroutine was design to test throughput so it should run without waitgroup.""",github:GithubAccount:1:7496278,2018-10-03T11:05:45.000+00:00,,0
github:GithubPullRequest:1:426604764,github:GithubPullRequest:1:219936521,"""Hi, semaphore acts as protection to avoid starting too many goroutines at once. `WaitGroup` is used to wait for everything to complete.\r\n\r\n`BenchmarkGoroutine` doesn't wait for all the goroutines to finish, so you are testing goroutine startup speed rather than throughput. It's somewhat unclear what you mean by \""throughput\"" in this case, but either way you would need to wait for all goroutines to finish, otherwise they will start affecting all other benchmarks. If you do want to benchmark goroutine startup speed, then you would need to add `b.StopTimer` before `wg.Wait`.""",github:GithubAccount:1:192964,2018-10-03T11:37:48.000+00:00,,0
github:GithubPullRequest:1:429609579,github:GithubPullRequest:1:222703171,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=h1) Report\n> Merging [#16](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/711dbdb7a222771ce15aaee1bb7b7c6e9731f208?src=pr&el=desc) will **decrease** coverage by `2.03%`.\n> The diff coverage is `0%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/16/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master      #16      +/-   ##\n==========================================\n- Coverage   97.46%   95.43%   -2.04%     \n==========================================\n  Files           5        5              \n  Lines         237      241       +4     \n==========================================\n- Hits          231      230       -1     \n- Misses          3        5       +2     \n- Partials        3        6       +3\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/16/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `94.39% <0%> (-1.8%)` | :arrow_down: |\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/16/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `95.37% <0%> (-2.75%)` | :arrow_down: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=footer). Last update [711dbdb...439348b](https://codecov.io/gh/panjf2000/ants/pull/16?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-10-14T09:24:39.000+00:00,,0
github:GithubPullRequest:1:433821356,github:GithubPullRequest:1:211603583,"""这种bugfix是不是应该赶紧修了？""",github:GithubAccount:1:8923413,2018-10-29T08:10:59.000+00:00,,0
github:GithubPullRequest:1:434126048,github:GithubPullRequest:1:211603583,"""@choleraehyq 这个很早就已经修复了这个pr一直忘了关。""",github:GithubAccount:1:7496278,2018-10-30T00:10:32.000+00:00,,0
github:GithubPullRequest:1:434126349,github:GithubPullRequest:1:211603583,"""@MrDragon1122 一般来说channel是不需要显式close的，只要没有goroutine持有channel，相关资源会自动释放。""",github:GithubAccount:1:7496278,2018-10-30T00:12:13.000+00:00,,0
github:GithubPullRequest:1:439758381,github:GithubPullRequest:1:231840723,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=h1) Report\n> Merging [#19](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=desc) into [develop](https://codecov.io/gh/panjf2000/ants/commit/92acf74bb71c1dc1758c61346c88325284978b3e?src=pr&el=desc) will **increase** coverage by `0.02%`.\n> The diff coverage is `100%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/19/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff             @@\n##           develop      #19      +/-   ##\n===========================================\n+ Coverage    97.46%   97.48%   +0.02%     \n===========================================\n  Files            5        5              \n  Lines          237      239       +2     \n===========================================\n+ Hits           231      233       +2     \n  Misses           3        3              \n  Partials         3        3\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/19/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `96.22% <100%> (+0.03%)` | :arrow_up: |\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/19/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `98.13% <100%> (+0.01%)` | :arrow_up: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=footer). Last update [92acf74...e7bacd0](https://codecov.io/gh/panjf2000/ants/pull/19?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2018-11-19T03:06:06.000+00:00,,0
github:GithubPullRequest:1:439758480,github:GithubPullRequest:1:231840723,"""我自己写了测试示例\r\n重复\r\nants.NewPoolWithFunc()\r\n然后\r\n进行Resize(0) && Release\r\n但仍发现内存泄漏现象，追溯到了NewTicker没有进行Stop可能导致\r\n\r\nflat  flat%   sum%        cum   cum%\r\n\r\n 7168.57kB 77.60% 77.60%  7168.57kB 77.60%  time.NewTicker\r\n\r\n\r\n\r\n""",github:GithubAccount:1:7931755,2018-11-19T03:06:50.000+00:00,,0
github:GithubPullRequest:1:439781607,github:GithubPullRequest:1:231840723,"""突然看到一个PR有更完善的解决方式，不知道为啥没有PR成功""",github:GithubAccount:1:7931755,2018-11-19T06:07:43.000+00:00,,0
github:GithubPullRequest:1:439793352,github:GithubPullRequest:1:231840723,"""另外一个pr跟你大概是完成类似的功能，不过那个failed之后作者就没再更新了，所以就没有merge，你要是有时间不如参考下他的代码再优化下？就放到这个pr里。""",github:GithubAccount:1:7496278,2018-11-19T07:14:58.000+00:00,,0
github:GithubPullRequest:1:456033956,github:GithubPullRequest:1:246250598,"""# [Codecov](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=h1) Report\n> Merging [#23](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=desc) into [master](https://codecov.io/gh/panjf2000/ants/commit/812dd4e01075be3cf97429a43abaf6837908cdcd?src=pr&el=desc) will **decrease** coverage by `1.02%`.\n> The diff coverage is `71.42%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/panjf2000/ants/pull/23/graphs/tree.svg?width=650&token=JFa3laaGKq&height=150&src=pr)](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master      #23      +/-   ##\n==========================================\n- Coverage   97.07%   96.04%   -1.03%     \n==========================================\n  Files           5        5              \n  Lines         239      253      +14     \n==========================================\n+ Hits          232      243      +11     \n- Misses          3        5       +2     \n- Partials        4        5       +1\n```\n\n\n| [Impacted Files](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pool\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/23/diff?src=pr&el=tree#diff-cG9vbF9mdW5jLmdv) | `98.13% <ø> (+2.8%)` | :arrow_up: |\n| [pool.go](https://codecov.io/gh/panjf2000/ants/pull/23/diff?src=pr&el=tree#diff-cG9vbC5nbw==) | `96.22% <ø> (-1.89%)` | :arrow_down: |\n| [worker\\_func.go](https://codecov.io/gh/panjf2000/ants/pull/23/diff?src=pr&el=tree#diff-d29ya2VyX2Z1bmMuZ28=) | `86.66% <71.42%> (-13.34%)` | :arrow_down: |\n| [worker.go](https://codecov.io/gh/panjf2000/ants/pull/23/diff?src=pr&el=tree#diff-d29ya2VyLmdv) | `86.66% <71.42%> (-13.34%)` | :arrow_down: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=footer). Last update [812dd4e...5bbc9e1](https://codecov.io/gh/panjf2000/ants/pull/23?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n""",github:GithubAccount:1:22429695,2019-01-21T11:00:28.000+00:00,,0
github:GithubPullRequest:1:456071084,github:GithubPullRequest:1:246250598,"""@choleraehyq \r\nbuild失败了，解决一下？""",github:GithubAccount:1:7496278,2019-01-21T13:18:19.000+00:00,,0
github:GithubPullRequest:1:456261758,github:GithubPullRequest:1:246250598,"""@panjf2000 这是测试覆盖率的问题吧，我已经测了设置 PanicHandler 的情况了，不设置的情况一测就 panic 了，而且是在一个 worker 里 panic，没法 recover""",github:GithubAccount:1:8923413,2019-01-22T03:45:04.000+00:00,,0
github:GithubPullRequest:1:456270386,github:GithubPullRequest:1:246250598,"""@choleraehyq \r\n三点：\r\n1. CI failed是因为TestPanicHandler测试失败了\r\n![image](https://user-images.githubusercontent.com/7496278/51513040-ba5fe680-1e43-11e9-92eb-6af6fa1242c9.png)\r\n2. 在Worker的recover里面，需要再加一个w.pool.decRunning()，因为panic之后这个goroutine就销毁了，所以要更新pool中的可用worker数量\r\n3. 麻烦在pool_func.go和worker_func.go里面也相应地加上PanicHandler的逻辑以及对应的unit tests\r\n\r\nThanks.""",github:GithubAccount:1:7496278,2019-01-22T04:50:28.000+00:00,,0
github:GithubPullRequest:1:456273052,github:GithubPullRequest:1:246250598,"""@panjf2000 thanks，修了""",github:GithubAccount:1:8923413,2019-01-22T05:10:00.000+00:00,,0
github:GithubPullRequest:1:456277710,github:GithubPullRequest:1:246250598,"""Thanks for your contributions to `ants`!""",github:GithubAccount:1:7496278,2019-01-22T05:41:10.000+00:00,,0
